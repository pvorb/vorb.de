/**!
 * (c) 2012 Paul Vorbach.
 *
 * MIT License (http://vorb.de/license/mit.html)
 */(function(){function e(e){var t=(new RegExp(e+"="+"(.+?)(&|$)")).exec(location.search);return t===null?null:t[1]}function t(e,t,n){return new Highcharts.Chart({chart:{renderTo:e,zoomType:"x"},title:{text:t},subtitle:{text:typeof document.ontouchstart=="undefined"?"Click and drag in the plot to zoom in":"Drag your finger over the plot to zoom in"},xAxis:{type:"datetime",maxZoom:12096e5,title:{text:"Date"}},yAxis:{title:{text:"Downloads"},min:.5,startOnTick:!1,showFirstLabel:!1},tooltip:{shared:!0},legend:{enabled:!1},plotOptions:{area:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#800"],[1,"rgba(255, 0, 0, 0)"]]},lineWidth:1,marker:{enabled:!1,states:{hover:{enabled:!0,radius:5}}},shadow:!1,states:{hover:{lineWidth:1}}}},series:[{type:"area",name:"Downloads",data:n}]})}function r(e){var t=[],n=e.rows,r=new Date(n[0].key[1]);for(var i in n)r=new Date(n[i].key[1]),t.push([r.getTime(),n[i].value]);return t}function i(e){var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+t.getDay()+1)/7)}function o(e){var t=[],n=i(new Date(e[0][0])),r=0,o,u;for(var a in e)o=e[a],u=new Date(o[0]),n!=i(u)?(t.push([u.getTime()-s,r]),r=o[1],n=i(u)):r+=o[1];return t}function u(e){var t=[],n=(new Date(e[0][0])).getMonth(),r=0,i,s;for(var o in e)i=e[o],s=new Date(i[0]),n!=s.getMonth()?(t.push({x:(new Date(s.getFullYear(),s.getMonth(),15)).getTime(),y:r}),r=i[1],n=s.getMonth()):r+=i[1];return t}$(document).ready(function(){var n,i,s,a=e("package");a===null&&(a="npm"),$("h2").html('Download statistics for package <input type="text" name="package" value="'+a+'"> <input type="submit" value="Show charts">'),$.getJSON("/dev/npm-stat/"+a+".json",function(n){var i=r(n);t("days","Downloads per day",i);var s=o(i);t("weeks","Downloads per week",s);var a=u(i);t("months","Downloads per month",a)}).error(function(){alert("Could not receive statistical data.")})});var n=864e5,s=3*n}).call();