<!DOCTYPE html>
<html lang="en" id="top">
  <head>
    <meta charset="utf-8">
    <title>For loop behavior in PHP | vorb.de</title>
    <link rel="stylesheet" href="/res/milten.css">
    <link rel="icon" href="/favicon.ico">
    <link rel="alternate" type="application/atom+xml" href="/log/feed.xml"
      title="Article feed">
    <link rel="alternate" type="application/atom+xml"
      href="/log/comment-feed.xml" title="Comment feed">
    <link rel="pingback" href="http://vorb.de/log/pingback">
    <meta name="author" content="Paul Vorbach">

    <meta name="keywords" content="english, note, dev, php">

  </head>
  <body>
    <header id="site">
      <a href="/" accesskey="h">vorb.de</a>
    </header>
    <nav id="nav">
      <ul id="branches">
        <li class="active"><a href="/log/" accesskey="l">/log</a>
        <li><a href="/info/" accesskey="i">/info</a>
      </ul>
      <ol id="path">
        <li><a href="/">vorb.de</a>

        <li><a href="/log/">log</a>

        <li><a href="/log/2012/">2012</a>

        <li><a href="/log/2012/07/">07</a>

        <li>for-loop-behavior.html

      </ol>
      <ol id="access">
        <li><a href="#top" title="To the top" id="back" accesskey="t">↑</a>
        <li><a href="#nav">Navigation</a>
        <li><a href="#content">Content</a>
        <li><a href="#comments" accesskey="c">Comments</a>
      </ol>
    </nav>
    <article id="content">
      <header>
        <h1>For loop behavior in PHP</h1>
        <p class="meta">by <span class="author">Paul Vorbach</span>, <span class="created">2012-07-09</span></p>

        <figure class="teaser">
          <img src="rollercoaster.jpg">
        </figure>

      </header>
      <section>
        <p>I always asked myself how often a function gets evaluated if you place it in the break condition of a for loop (or a for-each loop). Unfortunately I have always been too lazy to look for an answer – until today.</p>
<p>Let’s have a look at an implementation in <em>PHP</em>:</p>
<pre class="sourceCode php"><code class="sourceCode php"><span class="kw">&lt;?php</span>

<span class="kw">function</span> times<span class="ot">()</span> {
  <span class="fu">echo</span> <span class="st">&quot;evaluation</span><span class="kw">\n</span><span class="st">&quot;</span><span class="ot">;</span> <span class="co">// report evaluation</span>
  <span class="kw">return</span> <span class="dv">5</span><span class="ot">;</span>
}

<span class="fu">echo</span> <span class="st">&quot;# for loop:</span><span class="kw">\n\n</span><span class="st">&quot;</span><span class="ot">;</span>

<span class="kw">for</span> <span class="ot">(</span><span class="kw">$i</span> = <span class="dv">0</span><span class="ot">;</span> <span class="kw">$i</span> &lt; times<span class="ot">();</span> <span class="kw">$i</span>++<span class="ot">)</span> {
  <span class="fu">echo</span> <span class="kw">$i</span> . <span class="st">&quot;</span><span class="kw">\n</span><span class="st">&quot;</span><span class="ot">;</span>
}

<span class="kw">function</span> <span class="fu">set</span><span class="ot">()</span> {
  <span class="fu">echo</span> <span class="st">&quot;evaluation</span><span class="kw">\n</span><span class="st">&quot;</span><span class="ot">;</span> <span class="co">// report evaluation</span>
  <span class="kw">return</span> <span class="fu">array</span><span class="ot">(</span><span class="dv">0</span><span class="ot">,</span> <span class="dv">1</span><span class="ot">,</span> <span class="dv">2</span><span class="ot">,</span> <span class="dv">3</span><span class="ot">,</span> <span class="dv">4</span><span class="ot">);</span>
}

<span class="fu">echo</span> <span class="st">&quot;</span><span class="kw">\n</span><span class="st"># for-each loop:</span><span class="kw">\n\n</span><span class="st">&quot;</span><span class="ot">;</span>

<span class="kw">foreach</span> <span class="ot">(</span><span class="fu">set</span><span class="ot">()</span> <span class="kw">as</span> <span class="kw">$i</span><span class="ot">)</span> {
  <span class="fu">echo</span> <span class="kw">$i</span> . <span class="st">&quot;</span><span class="kw">\n</span><span class="st">&quot;</span><span class="ot">;</span>
}</code></pre>
<p>This will print</p>
<pre><code># for loop:

evaluation
0
evaluation
1
evaluation
2
evaluation
3
evaluation
4
evaluation

# for-each loop:

evaluation
0
1
2
3
4</code></pre>
<p>As we can see, PHP evaluates the break condition of a <em>for loop</em> at each iteration, whereas in a <em>foreach loop</em>, the set of values over which the loop iterates, only gets evaluated once.</p>
<p>So, if you use a function with an expensive calculation as a break condition in a for loop, just store that value in a temporary variable. E.g.:</p>
<pre class="sourceCode php"><code class="sourceCode php"><span class="kw">&lt;?php</span>

<span class="kw">for</span> <span class="ot">(</span><span class="kw">$i</span> = <span class="dv">0</span><span class="ot">,</span> <span class="kw">$times</span> = times<span class="ot">();</span> <span class="kw">$i</span> &lt; <span class="kw">$times</span><span class="ot">;</span> <span class="kw">$i</span>++<span class="ot">)</span> {
  <span class="co">// ...</span>
}</code></pre>

      </section>
      <footer class="meta">
        <p>Tags:

          <a href="/log/tag/english.html">english</a> ·

          <a href="/log/tag/note.html">note</a> ·

          <a href="/log/tag/dev.html">dev</a> ·

          <a href="/log/tag/php.html">php</a> 

        </p>

      </footer>
    </article>
    <section id="comments"></section>
    <aside id="extra">
      <form id="sf" action="/search.html" method="GET">
        <input type="search" name="s" accesskey="s" placeholder="Search">
      </form>
    </aside>
    <footer id="about">
      <p>© 2012 – Paul Vorbach.
        <a href="/info/contact.html">Contact</a>.</p>
    </footer>
    <script src="/res/comments.en.min.js"></script>
  </body>
</html>
